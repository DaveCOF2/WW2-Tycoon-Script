-- WW2 Tycoon Script v6.5 Adapted for Arceus X UI Library (Thresholdâ€‘only)

-- Load Arceus X UI Library
local lib = loadstring(game:HttpGet("https://raw.githubusercontent.com/AZYsGithub/Arceus-X-UI-Library/main/source.lua"))()

-- UI Setup
lib:SetTitle("WW2 Tycoon Script v6.5")
lib:SetIcon("http://www.roblox.com/asset/?id=9178187770")
lib:SetBackgroundColor(40, 40, 40)
lib:SetButtonsColor(55, 55, 55)
lib:SetCloseBtnColor(255, 0, 0)

-- Services & References
local Players          = game:GetService("Players")
local UserInputService = game:GetService("UserInputService")
local RunService       = game:GetService("RunService")
local LocalPlayer      = Players.LocalPlayer
local TycoonsFolder    = workspace:FindFirstChild("Tycoon Systems") and workspace["Tycoon Systems"].Factory.Tycoons

-- Utility: find your tycoon
local function getPlayerTycoon()
    for _, tycoon in ipairs(TycoonsFolder:GetChildren()) do
        if tycoon.Owner and tycoon.Owner.Value == LocalPlayer then
            return tycoon
        end
    end
    return nil
end

-- Droppers Configuration
local droppers = {
    { id = "d5",  label = "Basic Dropper"    },
    { id = "d10", label = "Advanced Dropper" },
    { id = "d15", label = "Super Dropper"    },
    { id = "d21", label = "Ultimate Dropper" },
}
for _, drop in ipairs(droppers) do
    local active = false
    lib:AddToggle("Auto " .. drop.label, function(state)
        active = state
        if state then
            task.spawn(function()
                while active do
                    local ty = getPlayerTycoon()
                    if ty and ty.CollectorEvent then
                        ty.CollectorEvent:FireServer(drop.id, "{}")
                    end
                    task.wait(0.05)
                end
            end)
        end
    end, false)
end

-- Auto Buy Upgrades Toggle
local buyActive = false
lib:AddToggle("Auto Buy Upgrades", function(state)
    buyActive = state
    if state then
        task.spawn(function()
            while buyActive do
                local ty = getPlayerTycoon()
                if ty then
                    for _, part in ipairs(ty:GetDescendants()) do
                        if part.Name == "Head" and part:IsA("BasePart") and part.BrickColor == BrickColor.new("Shamrock") then
                            local root = LocalPlayer.Character and LocalPlayer.Character:FindFirstChild("HumanoidRootPart")
                            if root then
                                root.CFrame = part.CFrame + Vector3.new(0, 5, 0)
                                task.wait(1)
                            end
                        end
                    end
                end
                task.wait(2)
            end
        end)
    end
end, false)

-- Cash Threshold Setting
local cashThreshold = 0
local useThreshold   = false
local thresholdOptions = {"0","500","1000","5000","10000","20000"}
lib:AddComboBox("Cash Threshold", thresholdOptions, function(selection)
    cashThreshold = tonumber(selection) or 0
    print("Cash threshold set to: $" .. cashThreshold)
end)
lib:AddToggle("Use Cash Threshold", function(state)
    useThreshold = state
end, false)

-- Utility to read current cash
local function getCurrentCashValue()
    local tycoon = getPlayerTycoon()
    if not tycoon then return 0 end
    local gui = tycoon:FindFirstChild("Essentials")
        and tycoon.Essentials:FindFirstChild("Giver")
        and tycoon.Essentials.Giver:FindFirstChild("CashScreen")
        and tycoon.Essentials.Giver.CashScreen:FindFirstChild("SurfaceGui")
        and tycoon.Essentials.Giver.CashScreen.SurfaceGui:FindFirstChild("TextLabel")
    if gui then
        local txt = gui.Text:gsub("[^%d]", "")
        return tonumber(txt) or 0
    end
    return 0
end

-- Auto Collect Cash Toggle
local autoCollect = false
lib:AddToggle("Auto Collect Cash", function(state)
    autoCollect = state
    if state then
        task.spawn(function()
            while autoCollect do
                local ty = getPlayerTycoon()
                if ty then
                    local cur = getCurrentCashValue()
                    if (not useThreshold) or (cur >= cashThreshold) then
                        local part = ty:FindFirstChild("Essentials")
                            and ty.Essentials:FindFirstChild("Giver")
                            and ty.Essentials.Giver:FindFirstChild("GivePart")
                        if part then
                            local hrp = LocalPlayer.Character and LocalPlayer.Character:FindFirstChild("HumanoidRootPart")
                            if hrp then
                                hrp.CFrame = CFrame.new(part.Position + Vector3.new(0,5,0)) * CFrame.Angles(0, math.rad(180), 0)
                                print("Collected cash: $"..cur)
                            end
                        end
                    end
                end
                task.wait(2)
            end
        end)
    end
end, false)

-- Anti-AFK Toggle
lib:AddToggle("Anti-AFK", function(state)
    if state then
        Players.LocalPlayer.Idled:Connect(function()
            UserInputService:SendInputEvent(Enum.UserInputType.MouseMovement)
        end)
    end
end, true)

-- Player Cheats Section
-- Walk Speed ComboBox
local speedOpts = {"16","30","50","100"}
lib:AddComboBox("Walk Speed", speedOpts, function(sel)
    local v = tonumber(sel)
    if v and LocalPlayer.Character then
        local hum = LocalPlayer.Character:FindFirstChildOfClass("Humanoid")
        if hum then hum.WalkSpeed = v end
    end
end)
-- Infinite Jump Toggle
local infJump = false
lib:AddToggle("Infinite Jump", function(state) infJump = state end, false)
UserInputService.JumpRequest:Connect(function()
    if infJump and LocalPlayer.Character then
        LocalPlayer.Character:FindFirstChildOfClass("Humanoid"):ChangeState(Enum.HumanoidStateType.Jumping)
    end
end)
-- Noclip Toggle
local noclipConn
lib:AddToggle("Noclip", function(state)
    if state then
        noclipConn = RunService.Stepped:Connect(function()
            if LocalPlayer.Character then
                for _,p in ipairs(LocalPlayer.Character:GetDescendants()) do
                    if p:IsA("BasePart") then p.CanCollide = false end
                end
            end
        end)
    elseif noclipConn then noclipConn:Disconnect() end
end, false)
-- Teleport to Tycoon Button
lib:AddButton("Teleport to Tycoon", function()
    local ty = getPlayerTycoon()
    local root = LocalPlayer.Character and LocalPlayer.Character:FindFirstChild("HumanoidRootPart")
    if ty and root and ty:FindFirstChild("SpawnLocation") then
        root.CFrame = ty.SpawnLocation.CFrame + Vector3.new(0,5,0)
    end
end)
-- Reset Character Button
lib:AddButton("Reset Character", function()
    local h = LocalPlayer.Character and LocalPlayer.Character:FindFirstChildOfClass("Humanoid")
    if h then h.Health = 0 else LocalPlayer:LoadCharacter() end
end)

print("WW2 Tycoon Script (Arceus) loaded.")
